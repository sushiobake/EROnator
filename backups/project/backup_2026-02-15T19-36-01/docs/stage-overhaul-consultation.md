# Stage 構造見直し：実装前の相談事項

**作成日: 2026-02-16**  
バックアップあり。抜本的に変えてよい前提で、実装前に決めたいことをまとめる。

**実装済み**: StageV2 を新規作成し、page / TopScreen で切り替え完了。旧 Stage は残置。

---

## 1. 現状の構造（問題点）

| 環境 | 現状 | 問題 |
|------|------|------|
| **PC** | 1200×800 固定キャンバスを `scale()` でビューポートに合わせる | コンテンツ幅・フォントが viewport に反応しない。「一般的なサイト」とは違う |
| **スマホ縦** | 800×800 固定キャンバスを中央で scale。白板 400×400 固定 | 同上。Fluid 変数が効かない（固定 box 内で描画しているため） |
| **スマホ横** | visualViewport で 800×800 を収める。body スクロール禁止 | 複雑。Android 特有のハックあり |

**根本的な誤り**  
「デザインを固定ピクセルで作り、全体を scale する」ゲームUI方式。一般的な Web サイトは「ビューポート幅に合わせてレイアウト・フォント・余白が変わる」方式。

---

## 2. 実装前に決めたいこと

### A. ビジュアルの扱い

| 項目 | 選択肢 | 備考 |
|------|--------|------|
| **背景画像** | ① フルビューポートで引き続き使用 ② シンプルな単色/グラデに変更 ③ 小さい画面では非表示 | 現在 `/ilust/back.png` |
| **キャラ画像** | ① 全画面で表示（レイアウトは変える） ② 小さい画面では非表示 ③ アイコン化して常時表示 | 現在 `/ilust/inari_1.png`。PC で大きく、スマホでも表示 |
| **ロゴ** | ① トップのみ継続 ② 全画面にヘッダとして ③ トップのみ・デザイン変更 | 現在 `eronator_logo.jpg` |

**相談**  
キャラ・背景を「作品の世界観」として残すか、使いやすさ優先で削るか。

---

### B. レイアウト方針

| 項目 | 選択肢 | 備考 |
|------|--------|------|
| **基本構造** | ① フルスクロール（縦に流れる一般的なページ） ② ビューポート固定（今と同様にスクロールなし） ③ ハイブリッド（トップは固定、ゲーム中はスクロール可） | 一般的なサイトは ① |
| **コンテンツ幅** | ① `max-width: 600px` など中央寄せ ② 画面幅いっぱい（padding のみ） ③ ブレークポイントで切り替え | 読みやすさ的には ① |
| **白板（質問・選択肢のエリア）** | ① カードとして `max-width` で中央 ② 画面幅に合わせて伸縮 ③ キャラと横並び（PC）/ 縦積み（スマホ） | 現在は固定 px の白板内 |
| **キャラとコンテンツの関係** | ① キャラ左・コンテンツ右（PC）。スマホは上にキャラ、下にコンテンツ ② キャラは背景扱い。前面にコンテンツのみ ③ キャラ非表示にしてコンテンツ中心 | 現状は ① に近いが固定 scale |

**相談**  
「ゲームっぽさ」と「一般的なサイトの使いやすさ」のどちらを優先するか。

---

### C. ブレークポイント

| 項目 | 選択肢 | 備考 |
|------|--------|------|
| **切り替え幅** | ① 768px のみ（現状） ② 640px / 768px / 1024px の複数 ③ 768px を維持しつつ、その他は Fluid で連続変化 | ui-goals では「1〜2 箇所」を推奨 |
| **スマホ縦/横** | ① 同じレイアウト（横も縦と同じような流れ） ② 横は特別レイアウト（現状の visualViewport 対応など） | 横は利用頻度低い可能性 |

**相談**  
スマホ横を特別扱いするか、縦と同様のシンプルなレイアウトにするか。

---

### D. 画面ごとの扱い

| 画面 | 現状 | 相談 |
|------|------|------|
| **トップ** | Stage + ロゴ + 文言 + ボタン | トップだけ別デザイン（ランディング風）にするか |
| **AI Gate** | Stage + 質問 + 3 択 | ゲーム画面と共通レイアウトでよいか |
| **Quiz** | Stage + 質問番号 + 質問文 + 6 択 + 戻る | 同上 |
| **Reveal** | Stage + サムネ + タイトル + はい/いいえ | 同上 |
| **Success / AlmostSuccess** | Stage + 正解カード + おすすめ横スクロール | 横スクロールは継続でよいか |
| **FailList** | Stage + 候補横スクロール + 入力 | 同上 |

**相談**  
全画面を同一レイアウトにするか、トップだけ大きく変えるか。

---

### E. 実装の進め方

| 項目 | 選択肢 | 備考 |
|------|--------|------|
| **範囲** | ① Stage  only（背景・キャラ・白板の配置のみ） ② Stage + 各画面コンポーネント（Quiz 等のレイアウトも含む） ③ レイアウト + デザイン全般（色・影・角丸など） | ① が最小。② が現実的 |
| **段階** | ① 一気に差し替え ② まず PC を直し、スマホは後から ③ まずスマホ縦を直し、PC は後から | 離脱が多いと想定される方を優先 |
| **互換** | ① 既存 Stage を削除して新規実装 ② 新しいレイアウトを別コンポーネントにして、フラグで切り替え | ロールバックしやすさ |

---

## 3. こちらからの提案（参考）

1. **ビジュアル**  
   キャラ・背景は残しつつ、レイアウトは「ビューポートに合わせて伸縮する」形に変更。小さい画面ではキャラを小さくするか、上部にコンパクト表示。

2. **基本構造**  
   フルスクロール（一般的なサイト方式）。コンテンツは `max-width: 540px` 程度で中央寄せ。タップ領域は 44px 以上。

3. **ブレークポイント**  
   768px のみ。それ以外は Fluid（clamp / %）で連続変化。

4. **進め方**  
   Stage を `StageV2` として新規実装し、page.tsx で切り替え可能にする。安定したら旧 Stage を削除。

---

## 4. 決めてほしいこと（簡潔に）

1. キャラ・背景は残す？ 簡素化する？
2. スクロールあり（一般的なサイト）にする？ ビューポート固定のまま？
3. スマホ横は特別レイアウトを維持？ 縦と同じでよい？
4. トップだけ大きく変える？ 全画面を統一？
5. 実装の進め方（一気 / 段階、ロールバック可否）

上記が決まれば、具体的な実装案（コンポーネント構造・CSS方針）を起こします。
