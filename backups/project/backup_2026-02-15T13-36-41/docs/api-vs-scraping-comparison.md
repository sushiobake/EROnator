# API取得データ vs スクレイピング取得データ - 比較結果

## テスト作品

- URL: https://www.dmm.co.jp/dc/doujin/-/detail/=/cid=d_704027/
- content_id: d_704027
- タイトル: またやってしまった稲荷さん4 〜寝過ごし編〜

## データ比較結果

### 【1. API取得データ】

**取得できる情報:**
- ✅ タイトル
- ✅ content_id / product_id
- ✅ 発売日（date）
- ✅ ページ数/時間（volume）
- ✅ URL / affiliateURL
- ✅ 画像URL（imageURL.large）
- ✅ 価格情報（prices）
- ✅ レビュー情報（review）
- ✅ ジャンル（iteminfo.genre）
- ✅ シリーズ情報（iteminfo.series）
- ✅ メーカー情報（iteminfo.maker）
- ✅ レーベル情報（iteminfo.label）
- ✅ 作者情報（iteminfo.author）- ただし、この作品では取得できず

**取得できない情報:**
- ❌ **作品コメント（commentText）** ← **これが最重要**

### 【2. スクレイピング取得データ】

**取得できる情報:**
- ✅ タイトル
- ✅ CID
- ✅ 作者名（HTMLから抽出）
- ✅ サムネイルURL
- ✅ 公式タグ（officialTags）
- ✅ **作品コメント（commentText）** ← **これが最重要**
- ✅ rawText（dt/ddテキスト + description的なブロック）

### 【3. 比較分析】

#### 重複する情報（どちらでも取得可能）

1. **タイトル**: APIとスクレイピングの両方で取得可能
   - → **APIを優先**（取得が速い）

2. **サムネイルURL**: API（imageURL.large）とスクレイピングの両方で取得可能
   - → **APIを優先**（取得が速い）

3. **ジャンル/タグ**: API（iteminfo.genre）とスクレイピング（officialTags）の両方で取得可能
   - → **APIを優先**（取得が速い、IDも取得可能）

4. **作者名**: API（iteminfo.author）とスクレイピングの両方で取得可能
   - → **APIを優先**（ただし、この作品ではAPIで取得できず）

#### APIのみで取得できる情報

1. **content_id / product_id**: 作品の識別子
2. **発売日（date）**: 作品の発売日
3. **ページ数/時間（volume）**: 作品のページ数や収録時間
4. **affiliateURL**: アフィリエイトリンク
5. **価格情報（prices）**: 作品の価格
6. **レビュー情報（review）**: レビュー数と平均評価
7. **シリーズ情報（iteminfo.series）**: シリーズ名とID
8. **メーカー情報（iteminfo.maker）**: メーカー名とID
9. **レーベル情報（iteminfo.label）**: レーベル名とID

#### スクレイピングのみで取得できる情報

1. **作品コメント（commentText）**: **準有名タグ生成に必須**
2. **rawText**: 作品コメント抽出の元データ（dt/ddテキスト + description的なブロック）

## 結論

### スクレイピングで追加取得すべき情報

**→ 作品コメント（commentText）のみ**

理由:
- 準有名タグ生成に必須の情報
- APIでは取得できない
- その他の情報はAPIで取得可能なため、スクレイピングでは不要

### 実装方針

1. **API取得データを優先**: タイトル、作者名、タグ、サムネイルURLなどはAPIから取得
2. **スクレイピングは作品コメントのみ**: 作品コメント（commentText）のみをスクレイピングで取得
3. **重複を避ける**: スクレイピングでは作品コメント以外の情報は取得しない（APIで取得済みのため）

### 効率的なデータ取得フロー

```
1. APIで作品情報を取得
   ├─ タイトル、作者名、タグ、サムネイルURLなど
   └─ 作品コメントは取得できない

2. スクレイピングで作品コメントのみを取得
   └─ 作品コメント（commentText）のみを追加取得

3. データを統合
   ├─ APIデータをベースに
   └─ 作品コメントを追加
```

## 作品コメントの例

```
作品コメント 【あらすじ】 美人でスタイル抜群の『稲荷（いなり）さん』が 「またやってしまう」お話。 その日、終電を寝過ごしてしまい 見知らぬ田舎町に着いた稲荷さん。 雨の中、通りすがった男性に 「なんでもするので助けてほしい」とすがりついた。 助けてはもらったが その言葉通り「なんでも」することになり…… 【収録内容】 ・本編（30P） ・おまけ（4P） 【Xアカウント】 @obake_sushi（すしおばけ） 【注意事項】 ・本作に登場する人物はすべて成人済みです ・本作に登場する人物・団体・設定はすべてフィクションです。 ・本作はAI生成物に加筆して作成しております
```

この作品コメントから、AIで準有名タグを生成することが可能です。
