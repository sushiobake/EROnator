/**
 * ChatGPTç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
 * æ—¢å­˜ã®aiPrompt.tsã®è¨­è¨ˆã‚’ãã®ã¾ã¾ä½¿ç”¨
 * - æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆã¯åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ç”Ÿæˆï¼ˆæ·»ä»˜ç”¨ï¼‰
 * - æº–æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆã¯æ¯Žå›žæœ€æ–°ã®tagRanks.jsonã‹ã‚‰ç”Ÿæˆ
 */

import * as fs from 'fs';
import * as path from 'path';
import * as dotenv from 'dotenv';
dotenv.config();

import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('ðŸ“ ChatGPTç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆï¼ˆæ—¢å­˜è¨­è¨ˆæº–æ‹ ï¼‰');
  
  // 1. æº–æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆï¼ˆA/Bãƒ©ãƒ³ã‚¯ï¼‰ã‚’æœ€æ–°ã®tagRanks.jsonã‹ã‚‰å–å¾—
  const ranksPath = path.join(process.cwd(), 'config', 'tagRanks.json');
  
  if (!fs.existsSync(ranksPath)) {
    console.error('tagRanks.jsonãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    process.exit(1);
  }
  
  const content = fs.readFileSync(ranksPath, 'utf-8');
  const data = JSON.parse(content);
  const ranks = data.ranks || {};
  
  // Aãƒ©ãƒ³ã‚¯ã®ã¿æŠ½å‡ºï¼ˆBã‚¿ã‚°ã¯ä½¿ç”¨ç¦æ­¢ï¼‰
  const aTags: string[] = [];
  const bTags: string[] = [];
  
  for (const [name, rank] of Object.entries(ranks)) {
    if (rank === 'A') aTags.push(name);
    else if (rank === 'B') bTags.push(name);
  }
  
  // ã‚½ãƒ¼ãƒˆ
  aTags.sort((a, b) => a.localeCompare(b, 'ja'));
  bTags.sort((a, b) => a.localeCompare(b, 'ja'));
  
  console.log(`   Aãƒ©ãƒ³ã‚¯: ${aTags.length}å€‹`);
  console.log(`   Bãƒ©ãƒ³ã‚¯: ${bTags.length}å€‹ï¼ˆä½¿ç”¨ç¦æ­¢ï¼‰`);
  
  // 2. æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆã‚’DBã‹ã‚‰å–å¾—ï¼ˆæœ€æ–°ã®ã‚‚ã®ã‚’ä½¿ç”¨ï¼‰
  console.log('   æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆã‚’DBã‹ã‚‰å–å¾—ä¸­...');
  const officialTags = await prisma.tag.findMany({
    where: { tagType: 'OFFICIAL' },
    select: { displayName: true },
    orderBy: { displayName: 'asc' }
  });
  const officialTagNames = officialTags.map(t => t.displayName);
  console.log(`   æœ‰åã‚¿ã‚°: ${officialTagNames.length}å€‹`);
  
  // æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›ï¼ˆæ·»ä»˜ç”¨ï¼‰
  const officialTagListPath = path.join(process.cwd(), 'data', 'chatgpt-export', 'official-tags-list.txt');
  const officialTagListStr = officialTagNames.join('ã€');
  fs.mkdirSync(path.dirname(officialTagListPath), { recursive: true });
  fs.writeFileSync(officialTagListPath, `# æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆï¼ˆä½¿ç”¨ç¦æ­¢ï¼‰

${officialTagNames.join('\n')}

---
ä¸Šè¨˜ã®ã‚¿ã‚°ã¯æ—¢ã«ä½œå“ã«ä»˜ä¸Žæ¸ˆã¿ã®ãŸã‚ã€matchedTagsã§ã‚‚suggestedTagsã§ã‚‚ã€çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‘ã€‚
`, 'utf-8');
  console.log(`   âœ… æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆå‡ºåŠ›: ${officialTagListPath}`);
  
  // 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
  const aTagListStr = aTags.join('ã€');
  const bTagListStr = bTags.join('ã€');
  const officialTagListStrShort = officialTagNames.length > 100
    ? officialTagNames.slice(0, 100).join('ã€') + '...ä»–'
    : officialTagNames.join('ã€');
  
  const prompt = `ã‚ãªãŸã¯ã€ŒERONATOR ã‚¿ã‚°æŠ½å‡ºAIã€ã§ã™ã€‚
ä½œå“ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä¸å¯§ã«èª­ã¿ã€ãã®ä½œå“ã®ç‰¹å¾´ã‚’çš„ç¢ºã«æ‰ãˆã‚‹ã‚¿ã‚°ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€æœ€é‡è¦ã€‘æœ‰åã‚¿ã‚°ï¼ˆSãƒ©ãƒ³ã‚¯ï¼‰ã¯çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢ï¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä»¥ä¸‹ã®ã€Œæœ‰åã‚¿ã‚°ã€ã¯æ—¢ã«ä½œå“ã«ä»˜ä¸Žæ¸ˆã¿ã®ãŸã‚ã€matchedTagsã§ã‚‚suggestedTagsã§ã‚‚
ã€çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‘ã€‚ã“ã‚Œã‚‰ã‚’ææ¡ˆã™ã‚‹ã¨ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚

â–  æœ‰åã‚¿ã‚°ï¼ˆä½¿ç”¨ç¦æ­¢ãƒªã‚¹ãƒˆï¼‰
${officialTagListStrShort}

â€»å®Œå…¨ãªãƒªã‚¹ãƒˆã¯æ·»ä»˜ã®ã€Œofficial-tags-list.txtã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
ä¸Šè¨˜ã®ã‚¿ã‚°ã¯å‡ºåŠ›ã«å«ã‚ãªã„ã§ãã ã•ã„ã€‚

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€å‡ºåŠ›å½¢å¼ã€‘JSONå½¢å¼ã§å‡ºåŠ›ï¼ˆJSONä»¥å¤–ã¯å‡ºåŠ›ç¦æ­¢ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{
  "workId": "d_XXXXX",
  "title": "ä½œå“ã‚¿ã‚¤ãƒˆãƒ«",
  "matchedTags": [
    {"displayName": "ã‚¿ã‚°å", "category": "ã‚«ãƒ†ã‚´ãƒª"}
  ],
  "suggestedTags": [
    {"displayName": "æ–°è¦ã‚¿ã‚°å", "category": "ã‚«ãƒ†ã‚´ãƒª"}
  ],
  "characterName": "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å" ã¾ãŸã¯ null
}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€matchedTagsã€‘å¿…é ˆæž ï¼ˆ0ã€œ3å€‹ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â–  æ‰‹é †ï¼ˆå¿…ãšã“ã®é †ç•ªã§è€ƒãˆã‚‹ï¼‰
1. ã¾ãšä½œå“ã‚³ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚“ã§ã€ä½œå“ã®ç‰¹å¾´ã‚’ç†è§£ã™ã‚‹
2. æ¬¡ã«ã€ŒAãƒ©ãƒ³ã‚¯ã‚¿ã‚°ãƒªã‚¹ãƒˆã€ã‚’ä¸Šã‹ã‚‰é †ã«è¦‹ã¦ã€è©²å½“ã™ã‚‹ã‚‚ã®ã‚’æŽ¢ã™
3. è©²å½“ã™ã‚‹ã‚¿ã‚°ãŒã‚ã‚Œã°ã€ãã‚Œã‚’ãã®ã¾ã¾å‡ºåŠ›ã™ã‚‹

â–  Aãƒ©ãƒ³ã‚¯ã‚¿ã‚°ãƒªã‚¹ãƒˆï¼ˆã“ã®ä¸­ã‹ã‚‰é¸ã¶ï¼‰â˜…Bãƒ©ãƒ³ã‚¯ã¯ä½¿ç”¨ç¦æ­¢â˜…
${aTagListStr}

â–  Bãƒ©ãƒ³ã‚¯ã‚¿ã‚°ï¼ˆä½¿ç”¨ç¦æ­¢ï¼‰
${bTagListStr}
ä¸Šè¨˜ã®Bãƒ©ãƒ³ã‚¯ã‚¿ã‚°ã¯ã€çµ¶å¯¾ã«ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‘ã€‚Aãƒ©ãƒ³ã‚¯ã®ã¿ä½¿ç”¨å¯èƒ½ã§ã™ã€‚

â–  è¶…é‡è¦ãƒ«ãƒ¼ãƒ«
- ã€ãƒªã‚¹ãƒˆã«ã‚ã‚‹ã‚¿ã‚°ã‚’ãã®ã¾ã¾ä½¿ã†ã€‘ï¼ˆæ–‡å­—ã‚’è¿½åŠ ãƒ»å¤‰æ›´ã—ãªã„ï¼ï¼‰
- NGä¾‹: ã€Œé›»ãƒžã€â†’ã€Œé›»ãƒžè²¬ã‚ã€ï¼ˆÃ—ï¼‰ã€ã€Œå‚¬çœ ã€â†’ã€Œå‚¬æ·«ã€ï¼ˆÃ—ï¼‰
- OKä¾‹: ã€Œé›»ãƒžã€â†’ã€Œé›»ãƒžã€ï¼ˆâ—‹ï¼‰ã€ã€Œå‚¬çœ ã€â†’ã€Œå‚¬çœ ã€ï¼ˆâ—‹ï¼‰
- ãƒªã‚¹ãƒˆã«å®Œå…¨ä¸€è‡´ã™ã‚‹ã‚¿ã‚°ã®ã¿å‡ºåŠ›ã™ã‚‹ã“ã¨
- ã‚³ãƒ¡ãƒ³ãƒˆã«ç›´æŽ¥æ›¸ã„ã¦ã‚ã‚‹å˜èªžã‚ˆã‚Šã€ãƒªã‚¹ãƒˆã«ã‚ã‚‹ã‚¿ã‚°ã‚’å„ªå…ˆã™ã‚‹

â–  çµ¶å¯¾ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³
- ã€Œâ—‹â—‹ãƒ—ãƒ¬ã‚¤ã€å½¢å¼ã¯å…¨é¢ç¦æ­¢ï¼ˆä¾‹: è§¦æ‰‹ãƒ—ãƒ¬ã‚¤ã€ãƒ¬ã‚ºãƒ—ãƒ¬ã‚¤ç­‰ï¼‰
- ã€Œâ—‹â—‹è²¬ã‚ã€å½¢å¼ã‚‚ç¦æ­¢ï¼ˆä¾‹: é›»ãƒžè²¬ã‚ã€ä¹³é¦–è²¬ã‚ç­‰ï¼‰
- ã‚³ãƒ¡ãƒ³ãƒˆã‹ã‚‰å˜èªžã‚’åˆ‡ã‚Šå‡ºã—ã¦ä¸¦ã¹ã‚‹ã®ã¯ç¦æ­¢
- æ—¢å­˜ã‚¿ã‚°ã«æŽ¥å°¾è¾žã‚’è¿½åŠ ã—ãªã„

â–  é¸ã³æ–¹ã®ã‚³ãƒ„
- ä½œå“ã®ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒžã«åˆã†ã‚¿ã‚°ã‚’é¸ã¶
- ã‚³ãƒ¡ãƒ³ãƒˆã«ç›´æŽ¥æ›¸ã„ã¦ãªãã¦ã‚‚ã€å†…å®¹ã‹ã‚‰æŽ¨æ¸¬ã§ãã‚‹ã‚¿ã‚°ã‚’é¸ã¶
  ä¾‹: ã€Œå‚¬æ·«æ¯’ã€â†’ã€Œå‚¬çœ ã€ã€ã€Œã‚·ã‚¹ã‚¿ãƒ¼ã€â†’ï¼ˆãƒªã‚¹ãƒˆã«ã‚ã‚Œã°é¸ã¶ï¼‰
- ã€Œã“ã®ä½œå“ã¯â—‹â—‹ã§ã™ã‹ï¼Ÿã€ã¨èžã‹ã‚Œã¦YESã¨ç­”ãˆã‚‰ã‚Œã‚‹ã‚‚ã®

â–  ä»¶æ•°: 0ã€œ3å€‹
- ä½œå“ã‚³ãƒ¡ãƒ³ãƒˆã®æƒ…å ±ãŒå°‘ãªã„å ´åˆã‚„ã€è©²å½“ã™ã‚‹ã‚¿ã‚°ãŒãªã„å ´åˆã¯0å€‹ã§ã‚‚OK
- ãŸã ã—ã€suggestedTagsã§é©åˆ‡ãªã‚¿ã‚°ã‚’ææ¡ˆã§ãã‚‹å ´åˆã¯ã€ãã¡ã‚‰ã‚’å„ªå…ˆ
- matchedTagsãŒ0å€‹ã§ã‚‚ã€suggestedTagsãŒ1å€‹ä»¥ä¸Šã‚ã‚Œã°å•é¡Œãªã—

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€suggestedTagsã€‘ææ¡ˆæž ï¼ˆ0ã€œ2å€‹ï¼‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ãƒªã‚¹ãƒˆã«ãªã„ç‰¹å¾´ãŒã‚ã‚‹å ´åˆã®ã¿ã€æ–°ã—ã„ã‚¿ã‚°ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚

â–  ææ¡ˆã®ãƒ«ãƒ¼ãƒ«
- ãƒªã‚¹ãƒˆã§è¡¨ç¾ã—ãã‚Œãªã„ã€ãã®ä½œå“ãªã‚‰ã§ã¯ã®ç‰¹å¾´ãŒã‚ã‚‹å ´åˆã®ã¿
- æ±Žç”¨æ€§ã®ã‚ã‚‹ã‚¿ã‚°ã‚’ææ¡ˆï¼ˆä»–ã®ä½œå“ã«ã‚‚ä½¿ãˆãã†ãªã‚‚ã®ï¼‰
- æœ‰åã‚¿ã‚°ï¼ˆä¸Šè¨˜ç¦æ­¢ãƒªã‚¹ãƒˆï¼‰ã¨è¢«ã‚‹ã‚‚ã®ã¯çµ¶å¯¾ã«ç¦æ­¢ï¼
- Aãƒ©ãƒ³ã‚¯ã‚¿ã‚°ãƒªã‚¹ãƒˆã¨ã‚‚è¢«ã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹
- Bãƒ©ãƒ³ã‚¯ã‚¿ã‚°ã¨ã‚‚è¢«ã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ï¼ˆBãƒ©ãƒ³ã‚¯ã¯ä½¿ç”¨ç¦æ­¢ï¼‰

â–  é€ èªžãƒ»åˆæˆèªžã¯ç¦æ­¢ï¼ï¼ˆè¶…é‡è¦ï¼‰
ææ¡ˆã™ã‚‹ã‚¿ã‚°ã¯ã€ä¸–é–“ã§åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã€‘ã®ã¿OKã§ã™ã€‚
- NG: ã€Œå³æŽ¡ç”¨ã€ã€Œç”°èˆŽç§»ä½ã€ã€Œå¹´ä¸ŠãŠå§‰ã•ã‚“ã€ã€Œåˆæ‹ç›¸æ‰‹ã€ã€Œå¯†å®¤ç›£ç¦ã€
  â†’ ã“ã‚Œã‚‰ã¯ã€Œæ–‡ç¯€ï¼‹æ–‡ç¯€ã€ã‚’çµ„ã¿åˆã‚ã›ãŸé€ èªžãªã®ã§NG
- OK: ã€Œãƒ–ãƒ©ãƒƒã‚¯ä¼æ¥­ã€ã€Œãƒãƒ‹ãƒ¼ãƒˆãƒ©ãƒƒãƒ—ã€ã€Œã‚»ãƒƒã‚¯ã‚¹ãƒ¬ã‚¹ã€
  â†’ ã“ã‚Œã‚‰ã¯ä¸€èˆ¬çš„ã«ä½¿ã‚ã‚Œã‚‹è¨€è‘‰ãªã®ã§OK

åˆ¤æ–­åŸºæº–: ãã®è¨€è‘‰ã‚’Googleæ¤œç´¢ã—ã¦ã€æ™®é€šã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹
ã€Œâ—‹â—‹ â—‹â—‹ã€ã¨2ã¤ã®å˜èªžã‚’ä¸¦ã¹ãŸã ã‘ã®é€ èªžã¯çµ¶å¯¾ã«ç¦æ­¢ï¼

â–  çµ¶å¯¾ã«ææ¡ˆç¦æ­¢
- ã‚µãƒ¼ã‚¯ãƒ«åã€ä½œè€…åã€ä½œå“ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚·ãƒªãƒ¼ã‚ºå
- ãƒšãƒ¼ã‚¸æ•°ã€å½¢å¼ï¼ˆãƒ•ãƒ«ã‚«ãƒ©ãƒ¼ã€PDFç­‰ï¼‰
- ã‚¤ãƒ™ãƒ³ãƒˆåã€ä¾¡æ ¼ã€è²©å£²æƒ…å ±
- 1æ–‡å­—ã®ã‚¿ã‚°ã€æ•°å­—ã ã‘ã®ã‚¿ã‚°
- ä¸€èˆ¬çš„ã™ãŽã‚‹èªžï¼ˆã‚¨ãƒ­ã€ã‚»ãƒƒã‚¯ã‚¹ã€æ¼«ç”»ã€ä¸­å‡ºã—ç­‰ï¼‰
- ä½œå“å›ºæœ‰ã™ãŽã‚‹èªžï¼ˆä»–ã®ä½œå“ã«ä½¿ãˆãªã„ã‚‚ã®ï¼‰
- 2ã¤ã®å˜èªžã‚’çµ„ã¿åˆã‚ã›ãŸé€ èªžï¼ˆã€Œå³æŽ¡ç”¨ã€ã€Œç”°èˆŽç§»ä½ã€ç­‰ï¼‰
- æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‚¿ã‚°
- Aãƒ©ãƒ³ã‚¯ã‚¿ã‚°ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‚¿ã‚°
- Bãƒ©ãƒ³ã‚¯ã‚¿ã‚°ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã‚¿ã‚°ï¼ˆBãƒ©ãƒ³ã‚¯ã¯ä½¿ç”¨ç¦æ­¢ï¼‰

â–  ã‚«ãƒ†ã‚´ãƒªï¼ˆä»¥ä¸‹ã‹ã‚‰é¸ã¶ï¼‰
ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ / é–¢ä¿‚æ€§ / å±žæ€§ / å ´æ‰€ / ãã®ä»–

â–  ä»¶æ•°: 0ã€œ2å€‹ï¼ˆè‰¯ã„ææ¡ˆãŒãªã‘ã‚Œã°ç©ºé…åˆ—ã§OKï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€characterNameã€‘ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åï¼ˆ0ã€œ1äººï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä½œå“ã«æ˜Žç¢ºãªã€Œã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åã€ãŒã‚ã‚‹å ´åˆã®ã¿æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚

â–  æŠ½å‡ºOK
- å›ºæœ‰åè©žã¨ã—ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åï¼ˆä¾‹: éˆ´ã€…ã€æ—©ç¹”ã€ç¾Žå’²ï¼‰
- ã‚³ãƒ¡ãƒ³ãƒˆå†…ã«æ–‡å­—åˆ—ã¨ã—ã¦å­˜åœ¨ã™ã‚‹åå‰

â–  æŠ½å‡ºNGï¼ˆã“ã‚Œã‚‰ã¯ç¦æ­¢ï¼‰
- å±žæ€§èªžï¼ˆäººå¦»ã€ãƒ’ãƒ­ã‚¤ãƒ³ã€å½¼å¥³ã€å¤§å­¦ç”Ÿã€ã‚®ãƒ£ãƒ«ç­‰ï¼‰
- ä¸€èˆ¬åè©žï¼ˆå¥³æ€§ã€ç”·æ€§ã€ä¸»äººå…¬ç­‰ï¼‰
- ã‚³ãƒ¡ãƒ³ãƒˆã«å­˜åœ¨ã—ãªã„åå‰

â–  ä»¶æ•°: æ˜Žç¢ºãªåå‰ãŒã‚ã‚Œã°1äººã€ãªã‘ã‚Œã°null

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€æœ€çµ‚ãƒã‚§ãƒƒã‚¯ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–¡ matchedTagsã¯0ã€œ3å€‹ï¼ˆ0å€‹ã§ã‚‚OKã€ãŸã ã—suggestedTagsãŒã‚ã‚Œã°å•é¡Œãªã—ï¼‰
â–¡ suggestedTagsã¯0ã€œ2å€‹
â–¡ characterNameã¯1äººã¾ãŸã¯null
â–¡ workIdã€titleãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹
â–¡ ã™ã¹ã¦ã®ã‚¿ã‚°ãŒæœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆãƒ»Aãƒ©ãƒ³ã‚¯ã‚¿ã‚°ãƒªã‚¹ãƒˆã¨è¢«ã£ã¦ã„ãªã„ã‹
â–¡ Bãƒ©ãƒ³ã‚¯ã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã‹ï¼ˆBãƒ©ãƒ³ã‚¯ã¯çµ¶å¯¾ç¦æ­¢ï¼‰
â–¡ JSONå½¢å¼ã®ã¿ã§å‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã‹

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€é‡è¦ã€‘è¤‡æ•°ä½œå“ã‚’å‡¦ç†ã™ã‚‹å ´åˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
JSONé…åˆ—å½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š
[
  { "workId": "...", "title": "...", "matchedTags": [{"displayName": "...", "category": "..."}], "suggestedTags": [{"displayName": "...", "category": "..."}], "characterName": "..." },
  ...
]

â€»confidenceãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ä¸è¦ã§ã™ã€‚displayNameã¨categoryã®ã¿å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
`;

  // å‡ºåŠ›
  const outputPath = path.join(process.cwd(), 'data', 'chatgpt-export', 'chatgpt-prompt.txt');
  fs.mkdirSync(path.dirname(outputPath), { recursive: true });
  fs.writeFileSync(outputPath, prompt, 'utf-8');
  
  console.log(`\nâœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆå®Œäº†: ${outputPath}`);
  console.log(`   æ—¢å­˜ã®aiPrompt.tsã®è¨­è¨ˆã‚’ãã®ã¾ã¾ä½¿ç”¨`);
  console.log(`\nðŸ“Œ ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«:`);
  console.log(`   1. chatgpt-prompt.txt (ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ)`);
  console.log(`   2. official-tags-list.txt (æœ‰åã‚¿ã‚°ãƒªã‚¹ãƒˆ - æ·»ä»˜)`);
  console.log(`   3. test-10works.json (ä½œå“ãƒ‡ãƒ¼ã‚¿ - æ·»ä»˜)`);
}

main()
  .catch(e => {
    console.error('Error:', e);
    process.exit(1);
  })
  .finally(() => prisma.$disconnect());
