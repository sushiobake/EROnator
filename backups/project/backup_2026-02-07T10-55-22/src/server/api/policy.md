# Data Exposure Policy（実装の禁止を明文化）

## 原則

**クライアントへ返してよいのは「表示に必要な最小限の情報」のみ。**

## 絶対にクライアントへ返さない／配布しないもの

### (a) 質問プール全体、候補質問一覧、質問IDの全量
- 質問は1問ずつ返す（`QuestionResponse`）
- 質問プール全体や候補一覧は返さない

### (b) 辞書（正規化辞書・同義語辞書）、tags_ui.tsv 等の全量
- タグ情報は表示に必要な最小限のみ（`TagResponse`）
- 辞書データはserver側のみ保持

### (c) L1/L2の内部属性（推定根拠/evidence、confidenceの詳細内訳）
- confidenceは`P(top1)`のみ返す
- 重みの詳細内訳、evidence、内部計算過程は返さない

### (d) 候補作品の全量や上位大量リスト（上位K件以上は返さない）
- FAIL_LISTは`config.failListN`件のみ返す
- 全候補作品リストは返さない

### (e) ログ（当たり外れ、投票、自由入力）の生データ
- ログはserver側のみ保存
- クライアントへは返さない

## 実装方針

1. **API返却型を固定**: `src/server/api/types.ts` で最小限の型を定義
2. **デバッグ用フィールドは本番で無効化**: 環境変数で制御
3. **works/tags/質問プール全量をフロントbundleに含めない**: server保持が前提
4. **各エンドポイントごとに返却フィールドを固定**: 推測で追加しない

## チェックポイント

- [ ] 質問プール全体を返していないか
- [ ] タグ辞書全量を返していないか
- [ ] confidenceの詳細内訳を返していないか
- [ ] 候補作品の全量を返していないか
- [ ] ログの生データを返していないか
- [ ] デバッグ用フィールドが本番で無効化されているか
