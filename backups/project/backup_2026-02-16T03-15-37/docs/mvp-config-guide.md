# MVP コンフィグガイド（mvpConfig.json）

ゲームの挙動を変える設定は `config/mvpConfig.json` で行います。  
ここでは **flow** セクションのうち、よくいじる項目を説明します。

---

## flow.titleInitialTopN（タイトル頭文字の候補範囲）

**HARD_CONFIRM**（「この作品のタイトル、頭文字は「〇」かしら？」）で、  
**確度順の上位何件の作品**から頭文字・作者を選ぶかを指定します。

| 値 | 意味 |
|----|------|
| **1**（未設定時も 1） | 確度 1 位の作品だけから頭文字／作者を選ぶ（従来どおり） |
| **2 以上** | 確度 1 位〜N 位の作品から、未使用の頭文字／作者を順に選ぶ |

### 推奨とトレードオフ

- **1**  
  - 正解作品が一度でも確度 1 位になれば、その頭文字を聞ける。  
  - 一方で、1 位がずっと同じ作品だと、聞く頭文字の種類が少なくなる。

- **2 または 3**  
  - 頭文字のバリエーションが増え、同じ質問の繰り返しを抑えられる。  
  - 正解がずっと 1〜3 位に入っていないと、正解の頭文字を一度も聞けない可能性がある（N が大きいほどそのリスクは増える）。

- **5 以上**  
  - バリエーションはさらに増えるが、正解が top-N に入らないケースで、  
    「正解の頭文字を一度も聞かずに MAX_QUESTIONS で終了」しやすくなる。

**試すときの目安**: まず **2 か 3** で試し、正解に届くか・頭文字の出方を見てから調整してください。

### 設定例（config/mvpConfig.json）

```json
"flow": {
  ...
  "titleInitialTopN": 3
}
```

未設定の場合は 1 として扱われます。

---

## flow.summaryPreferRatio（まとめ質問の優先度）

**0〜1** の確率で、「まとめ質問だけ」に絞ってから 1 問を選びます。

- **0**（未設定時）: まとめを優先しない（まとめと通常タグを同じプールで選択）
- **0.3**: 30% の確率でまとめのみに絞る（デフォルト想定）
- **0.5**: 50% の確率でまとめのみに絞る（まとめをより出したいとき）

```json
"flow": {
  ...
  "summaryPreferRatio": 0.3
}
```

---

## その他の flow 項目

- **maxQuestions**: 1 ゲームの最大質問数（例: 40）
- **maxRevealMisses**: REVEAL 失敗の最大回数
- **failListN**: 失敗時にお見せする候補数
- **consecutiveNoForAtari**: 連続 NO がこの回数以上なら「当たり」狙いのタグを選ぶ（未設定時は 3）

詳細なスキーマは `src/server/config/schema.ts` を参照してください。
